class Solution {
    /**   
     * Definition of Middle:
     * - For odd length → exact middle node.
     * - For even length → second middle node
     *
     * Example:
     * 1 -> 3 -> 4 -> 7 -> 1 -> 2 -> 6
     * Middle = 7 → delete it
     *
     * 1 -> 2 -> 3 -> 4
     * Middle = 3 (second middle) → delete it
     *
     */
    public ListNode deleteMiddle(ListNode head) {
        // Edge case: single node list
        if (head.next == null) {
            return null;
        }

        // Get node just before middle
        ListNode prev = getPrevToMiddle(head);

        // Middle node to delete
        ListNode middle = prev.next;

        // Bypass the middle node
        prev.next = middle.next;

        // Break link for clarity (optional, helps GC)
        middle.next = null;

        return head;
    }

    private ListNode getPrevToMiddle(ListNode head) {
        ListNode slow = head;
        ListNode fast = head;
        ListNode slowPrev = null;

        while (fast != null && fast.next != null) {
            slowPrev = slow;
            slow = slow.next;
            fast = fast.next.next;
        }

        return slowPrev;
    }
}
